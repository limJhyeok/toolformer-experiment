# Toolformer Demonstration Notebook

**ì–¸ì–´ ì„ íƒ / Language Selection:**

- [ğŸ‡°ğŸ‡· í•œêµ­ì–´ (Korean)](README.ko.md)
- [ğŸ‡ºğŸ‡¸ English](README.md)

## ê°œìš”  
[ì´ Jupyter ë…¸íŠ¸ë¶](https://github.com/limJhyeok/toolformer-experiment/blob/main/jupyter.ipynb)ì€ **Toolformer** ì ‘ê·¼ ë°©ì‹ì„ ì‹œì—°í•©ë‹ˆë‹¤. ì´ ì ‘ê·¼ë²•ì—ì„œëŠ” ì–¸ì–´ ëª¨ë¸(GPT-J)ì„ API í˜¸ì¶œ ê¸°ëŠ¥ê³¼ í†µí•©í•˜ì—¬ ì™¸ë¶€ ì •ë³´ê°€ í•„ìš”í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤. í…ìŠ¤íŠ¸ ìƒì„± ì¤‘ì— API í˜¸ì¶œì„ ì‚½ì…í•˜ê³  í•´ë‹¹ ì‘ë‹µì„ í™œìš©í•˜ì—¬ ëª¨ë¸ì´ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ë™ì ìœ¼ë¡œ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì£¼ìš” íŠ¹ì§•  
- **API í˜¸ì¶œ í†µí•©**: ì™¸ë¶€ ì •ë³´ê°€ í•„ìš”í•œ í…ìŠ¤íŠ¸ì— API í˜¸ì¶œì„ ìë™ìœ¼ë¡œ ì‚½ì…í•©ë‹ˆë‹¤.  
- **ë™ì  API ì‹¤í–‰**: API í˜¸ì¶œì„ ì‹¤í–‰í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ì¶œë ¥ í…ìŠ¤íŠ¸ì— í†µí•©í•©ë‹ˆë‹¤.  
- **Loss ê¸°ë°˜ í‰ê°€/í•„í„°ë§**: API í˜¸ì¶œ ê²°ê³¼ê°€ ìˆëŠ” í…ìŠ¤íŠ¸ì™€ ì—†ëŠ” í…ìŠ¤íŠ¸ì˜ loss ê°’ì„ ë¹„êµí•˜ì—¬ íŒŒì¸íŠœë‹ì— ì í•©í•œ ë°ì´í„°ì…‹ì„ ê²°ì •í•©ë‹ˆë‹¤.  
- **ëª¨ë¸ íŒŒì¸íŠœë‹**: ì„ íƒëœ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ GPT-Jë¥¼ íŒŒì¸íŠœë‹í•˜ì—¬ APIë¥¼ ì¸ì‹í•˜ëŠ” í…ìŠ¤íŠ¸ ìƒì„±ì„ ê°œì„ í•©ë‹ˆë‹¤.  
- **ë°˜ë³µì  ì¶”ë¡ **: API ê²°ê³¼ê°€ í›„ì† í…ìŠ¤íŠ¸ ìƒì„±ì— ë™ì ìœ¼ë¡œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ë°˜ë³µì  í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

## ì‚¬ìš©ë²•  
### ì‚¬ì „ ìš”êµ¬ ì‚¬í•­  
1. í•„ìš”í•œ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤:  
   ```bash
   pip install torch transformers
   ```
   
2. ìµœì ì˜ ì„±ëŠ¥ì„ ìœ„í•´ **GPU**ì— ì ‘ê·¼ ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤.

### ë…¸íŠ¸ë¶ ì›Œí¬í”Œë¡œìš°  
1. **ì„¤ì •**:  
   - Hugging Face Transformers ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ GPT-J ëª¨ë¸ê³¼ í† í¬ë‚˜ì´ì €ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤.  
   - ë™ì  ë‚ ì§œ ê´€ë ¨ ì¿¼ë¦¬ë¥¼ ìœ„í•œ ë§ì¶¤í˜• `Calendar` API ë„êµ¬ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.  

2. **í”„ë¡¬í”„íŠ¸ ë° ë°ì´í„° ì¤€ë¹„**:  
   - API í˜¸ì¶œì´ í•„ìš”í•œ ê²½ìš° í†µí•©í•˜ë„ë¡ ëª¨ë¸ì— ì§€ì‹œí•˜ëŠ” í”„ë¡¬í”„íŠ¸ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.  
   - API í˜¸ì¶œ ìƒì„±ì„ ìœ„í•œ ì˜ˆì œ ì…ë ¥ ë°ì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

3. **API í˜¸ì¶œ ìƒì„± ë° ì‹¤í–‰**:  
   - ëª¨ë¸ì€ ì™¸ë¶€ ì •ë³´ê°€ í•„ìš”í•œ ê²½ìš° `[Calendar()]` API í˜¸ì¶œì„ ì‚½ì…í•œ í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.  
   - API í˜¸ì¶œì„ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ í…ìŠ¤íŠ¸ì— ë‹¤ì‹œ í†µí•©í•©ë‹ˆë‹¤.

4. **ì†ì‹¤ ê³„ì‚°**:  
   - ì„¸ ê°€ì§€ í…ìŠ¤íŠ¸ ë³€í˜•ì— ëŒ€í•œ ì†ì‹¤ ê°’ì„ ê³„ì‚°í•©ë‹ˆë‹¤:
     - API ê²°ê³¼ í¬í•¨ (`[Calendar() -> Today is Thursday, November 30, 2023.]`)
     - API ê²°ê³¼ ë¯¸í¬í•¨ (`[Calendar()]`)
     - ì¼ë°˜ í…ìŠ¤íŠ¸ (API í˜¸ì¶œ ì—†ìŒ)  
   - lossë¥¼ ë¹„êµí•˜ì—¬ fine-tuningì— ê°€ì¥ ì í•©í•œ ë°ì´í„°ì…‹ì„ í•„í„°ë§í•©ë‹ˆë‹¤.

5. **fine-tuning**:  
   - loss ë¹„êµì— ê¸°ë°˜í•œ fine-tuning ë°ì´í„°ì…‹ì„ ìƒì„±í•©ë‹ˆë‹¤.  
   - APIë¥¼ ì¸ì‹í•˜ëŠ” í…ìŠ¤íŠ¸ ìƒì„±ì„ ê°œì„ í•˜ê¸° ìœ„í•´ GPT-J ëª¨ë¸ì„ fine-tuningí•©ë‹ˆë‹¤.

6. **ì¶”ë¡ **:  
   - fine-tuningëœ ëª¨ë¸ì— ìƒˆ ì…ë ¥ì„ ì œê³µí•©ë‹ˆë‹¤.  
   - ëª¨ë¸ì´ API í˜¸ì¶œ(ì˜ˆ: `->`)ì„ ìƒì„±í•˜ë©´ API í˜¸ì¶œì„ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ í†µí•©í•œ ë’¤ ë°˜ë³µì ìœ¼ë¡œ ë””ì½”ë”©ì„ ê³„ì† ì§„í–‰í•©ë‹ˆë‹¤.

---

## ì˜ˆì‹œ  
### ì…ë ¥:  
```text
The store is never open on the weekend, so today it is closed.
```

### ì¶œë ¥:  
```text
The store is never open on the [Calendar() -> Today is Saturday, November 25, 2023.] weekend, so today it is closed.
```

## ì£¼ìš” ë‚´ìš©  
- **Loss ê¸°ë°˜ í•„í„°ë§**: API ê²°ê³¼ë¥¼ í¬í•¨í•˜ë©´ Lossê°€ ê°œì„ ë˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ í†µí•´ ë°ì´í„°ì…‹ì„ í•„í„°ë§í•©ë‹ˆë‹¤:
  ```bash
  # e.g.,
  API ê²°ê³¼ í¬í•¨ Loss: 2.84
  API ê²°ê³¼ ë¯¸í¬í•¨ Loss: 2.98
  ì¼ë°˜ í…ìŠ¤íŠ¸ (API í˜¸ì¶œ ì—†ìŒ) Loss: 3.83
  ```
  ```python
  # api_with_result_output.loss: 2.84
  # api_without_result_output.loss: 2.98
  # plain_output.loss: 3.83
  # filtering_threshold: ì‚¬ìš©ì ì •ì˜(e.g., 1.0)
  
  if api_with_result_output.loss < min(api_without_result_output.loss, plain_output.loss) + filtering_threshold:
    finetune_dataset = including_API_without_result + next_words
  else:
    finetune_dataset = plain_text + next_words
  ```
- **ë™ì  API í˜¸ì¶œ**: í…ìŠ¤íŠ¸ ìƒì„± ì¤‘ ëª¨ë¸ì´ ë„êµ¬(tool)ì™€ ì›í™œí•˜ê²Œ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.  
- **ì‚¬ìš©ì ì •ì˜ API**: `Calendar` ì™¸ì˜ ë‹¤ë¥¸ APIë¥¼ ì‰½ê²Œ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## í•™ìŠµ ëª©í‘œ  
1. ì™¸ë¶€ API ë„êµ¬ë¥¼ ì–¸ì–´ ëª¨ë¸ì— í†µí•©í•˜ëŠ” ë°©ë²•ì„ ì´í•´í•©ë‹ˆë‹¤.  
2. API í˜¸ì¶œì˜ ì˜í–¥ì„ í‰ê°€í•˜ê¸° ìœ„í•´ ì†ì‹¤ ê¸°ë°˜ í•„í„°ë§ì„ íƒêµ¬í•©ë‹ˆë‹¤.  
3. ë™ì  ë„êµ¬ ì§€ì› í…ìŠ¤íŠ¸ ìƒì„±ì„ ìœ„í•´ ì–¸ì–´ ëª¨ë¸ì„ íŒŒì¸íŠœë‹í•©ë‹ˆë‹¤.  
4. ì‹¤ì‹œê°„ API í™œìš©ì„ ìœ„í•œ ë°˜ë³µ ì¶”ë¡  íŒŒì´í”„ë¼ì¸ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

## ì°¸ê³  ìë£Œ  
1. [Toolformer: Language Models Can Teach Themselves to Use Tools (ì›ë³¸ ë…¼ë¬¸)](https://arxiv.org/abs/2302.04761)  
2. [lucidrains/toolformer-pytorch](https://github.com/lucidrains/toolformer-pytorch)

## ë…¸íŠ¸  
ì´ ë…¸íŠ¸ë¶ì€ **Toolformer** ì›ë¦¬ë¥¼ ì†Œê°œí•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬, ì‹¤ì‹œê°„ ë‚ ì”¨ ì—…ë°ì´íŠ¸ ë˜ëŠ” ì§€ì‹ ê²€ìƒ‰ ì‹œìŠ¤í…œê³¼ ê°™ì€ íŠ¹ì • ì‚¬ìš© ì‚¬ë¡€ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì¶”ê°€ API ë° ë§ì¶¤í˜• íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
